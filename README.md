# Noir + Garaga flow — Prove `x != y^2` and produce a Cairo verifier for Starknet

This repository demonstrates the recommended flow using **Noir** (to express the relation) and **Garaga** (to compile ACIR → Cairo verifier):
`Noir (x,y,w) -> ACIR -> Garaga -> Cairo verifier -> Deploy to Starknet`

## Files in this repo
- `noir/src/neq_square.nr` — Noir program (public inputs x,y; private w)
- `garaga/garaga.toml` — example Garaga config (edit as needed)
- `scripts/*` — helper scripts (template; edit per your toolchain)
- `starknet/verifier.cairo` — (output) Cairo verifier generated by Garaga (placeholder)
- `proofs/` — place generated proof artifacts here after running prover

## Step-by-step guide (recommended path)

### Prerequisites
- Install **Noir** compiler (see https://noir-lang.org)
- Install **Garaga** CLI (see Garaga docs / repo)
- Install required proving backend (e.g., Barretenberg) if using that backend with Garaga
- Install **Starknet CLI** (for deploy) or use a supported SDK (e.g., Hardhat + starknet plugin)

### 1) Compile Noir to ACIR
```bash
# produce noir/target/bytecode.acir
bash scripts/build_noir.sh
```

### 2) Compile ACIR → Cairo verifier with Garaga
```bash
bash scripts/garaga_compile.sh
# result (example): starknet/verifier.cairo
```
*Note:* Garaga may output additional helper files (ABI, types). Review garaga output directory.

### 3) Generate a STARK proof for a concrete (x,y)
You must provide public inputs (x,y) and private witness (w = inv(x - y^2) mod field).
For example, to prove x=10, y=3, set w=1.

Place input files under `proofs/` and run your prover. The command depends on chosen backend:
- If using Barretenberg or other backend, follow its CLI to create `proof.json` and `public.json`.

### 4) (Optional) Verify the proof off-chain
Use the verifier artifacts produced by Garaga to verify the proof locally (some toolchains provide a `garaga verify` step).

### 5) Deploy the Cairo verifier to Starknet testnet
After `garaga compile` you should have `starknet/verifier.cairo`.
Deploy with the Starknet CLI / account:
```bash
# Example (adjust network name)
starknet deploy --contract starknet/verifier.cairo --network alpha-goerli
```

### 6) Call the verifier on-chain
Use `starknet invoke` or write a small script to call the verifier entrypoint with the proof bytes/public inputs and observe verification success.

## Example values (you can use these to test)
- public: x = 10, y = 3
- private witness: w = 1

## Notes & troubleshooting
- The exact CLI commands vary between versions of Noir/Garaga/Barretenberg — check each project's docs.
- Garaga frequently evolves; adjust `garaga.toml` and CLI flags accordingly.
- If you prefer, I can generate a complete CI workflow (GitHub Actions) that runs on a runner with the toolchain installed to produce artifacts automatically — say the word and I'll add it.

## References
- Noir: https://noir-lang.org
- Garaga examples & docs: (see Garaga repo / blog posts about Starknet verifier integration)
- Starknet Cairo verifier / deploy: https://www.cairo-lang.org/docs/starknet/
